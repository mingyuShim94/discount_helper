# 할인도우미 UI 구조

## 전체 UI 구조

할인도우미는 사용자 친화적인 반응형 UI를 제공하며, 모바일과 데스크톱 환경에 따라 최적화된 레이아웃을 제공합니다.

## 레이아웃 구성

### 헤더 영역 (`Header.tsx`)

- 로고 및 사이트 이름
- 주요 탐색 메뉴
- 모바일에서 햄버거 메뉴로 변환

### 메인 콘텐츠 영역

- 페이지별 콘텐츠
- 모바일에서 단일 컬럼, 데스크톱에서 다중 컬럼 레이아웃

## 핵심 기능 UI

### 금액 입력 UI (`AmountInput` 컴포넌트)

- `AmountInput` 컴포넌트가 `app/store/[id]/page.tsx` 페이지 레벨에서 관리됨
- 데스크톱 및 모바일 화면 모두 일관된 위치에서 표시
- 금액 입력 필드 (기본값: 5,000원)
- 계산식 직접 입력 지원 (예: 1200+800)
- +1,000원, +100원 버튼으로 빠른 금액 추가
- 초기화 버튼
- POP 로고 체크박스 (추가 할인 적용 여부)

### 할인 계산기 (`DiscountResult.tsx`)

- 외부에서 전달받은 금액과 필터 옵션을 사용하여 할인 계산
- 다양한 할인 방법의 결과를 카드와 테이블 형태로 표시

#### 할인 필터 영역 (`DiscountFilter.tsx`)

- 멤버십 선택 (통신사 멤버십, 네이버 멤버십)
- 결제 방법 선택 (네이버페이, 카카오페이, 토스페이, 할인카드)
- 할인카드 할인률 직접 입력
- 모바일과 데스크톱 레이아웃에 최적화된 UI

#### 할인 결과 표시 영역

- **모바일 UI (화면 너비 < 768px)**
  - **탭 기반 UI**
    - '최적 할인' 탭: 최적 할인 방법 요약 및 체감가, 즉시 할인, 미래 혜택 카드
    - '전체 목록' 탭: 결제 방법별 카드 (접기/펼치기 기능)
    - '용어 설명' 탭: 할인 관련 용어 설명
- **데스크톱 UI (화면 너비 >= 768px)**
  - **2단 그리드 레이아웃**
    - 좌측: 할인 영수증 (sticky 포지션으로 스크롤 시에도 고정)
    - 우측: 할인 결과 테이블 (클릭 가능한 행)
  - **영수증-테이블 상호작용**
    - 테이블 행 클릭 시 좌측 영수증이 선택한 할인 방법으로 즉시 업데이트
    - 최적 할인으로 돌아가기 버튼으로 기본 상태로 복귀 가능

#### 할인 결과 카드

- 카드 헤더: 결제 방법, 총 혜택, 할인율
- 확장 시 표시 정보:
  - 체감가 (실제 체감 지불 금액)
  - 즉시 할인 금액
  - 미래 혜택 금액 (포인트 적립, 캐시백)
  - 이벤트 안내 메시지 (네이버페이 주말 캐시백 등)
  - 참고 사항 (할인 관련 추가 정보)

#### 할인 표시 컴포넌트 (`DiscountDetail.tsx`)

- **`DiscountReceipt` 컴포넌트**: 영수증 스타일로 할인 정보 표시

  - 영수증 헤더: 타이틀, 날짜 표시
  - 상점 정보 영역: 최적 할인 방법 표시
  - 총 할인 혜택: 혜택 금액과 할인율 표시
  - 항목 목록: 원래 금액, 즉시 할인, 실 결제액, 적립, 캐시백, 체감가
  - 참고 사항: 할인 관련 추가 정보
  - 바코드 영역: 시각적 효과를 위한 영수증 바코드

- **`DiscountCardDetail` 컴포넌트**: 카드 형태로 할인 정보 표시

  - 할인 혜택 요약: 총 할인 혜택, 체감가, 즉시 할인, 적립/캐시백, 실 결제액
  - 확장 시 표시되는 상세 정보:
    - 혜택 상세 정보: 원래 금액, 총 혜택 금액, 즉시 할인, 적립/캐시백
    - 할인 혜택 구성: 각 할인 유형별 상세 정보
    - 할인 적용 요약: 할인 계산 과정 단계별 표시
    - 참고 사항: 할인 관련 추가 정보

- **`DiscountComponent` 컴포넌트**: 할인 유형별 컴포넌트
  - 즉시 할인, 적립, 캐시백 유형별 시각적 구분
  - 유형별 색상 및 아이콘 적용
  - 할인 금액 및 설명 정보 표시

#### 할인 정보 표시 유틸리티 (`discountPresenter.ts`)

- **매장 정보 구조화 (STORE_CONFIGS)**:

  - 각 매장별 할인 정책을 체계적으로 관리하는 객체 구조
  - 매장별 통신사 멤버십, 네이버 멤버십, 카카오페이 굿딜 등의 할인율 설정
  - 각 할인에 대한 설명 텍스트 및 제한사항 관리
  - 매장 ID를 키로 사용하여 쉽게 매장 정보 조회 가능
  - `getStoreConfig` 함수를 통해 매장 설정 정보 편리하게 조회

- **할인 타입 체계화**:

  - `DiscountType` 타입 정의: "instant" | "point" | "cashback"
  - `DISCOUNT_TYPE_STYLES` 객체: 할인 유형별 일관된 스타일 제공
  - `DISCOUNT_SERVICE_COLORS` 객체: 서비스별(네이버, 카카오, 통신사 등) 색상 정의

- **모듈화된 할인 컴포넌트 생성 함수**:

  - 각 할인 유형별로 분리된 추가 함수:
    - `addTMembershipComponent`: T멤버십 할인 처리
    - `addNaverMembershipComponents`: 네이버 멤버십 즉시할인/포인트 처리
    - `addKtMembershipComponent`: KT 멤버십 할인 처리
    - `addLgMembershipComponent`: LG U+ 멤버십 할인 처리
    - `addNaverPayCashbackComponent`: 네이버페이 캐시백 처리
    - `addKakaoPayComponent`: 카카오페이 굿딜 할인 처리
    - `addDiscountCardComponents`: 할인카드 관련 컴포넌트 처리
  - 매장별 특성 자동 반영 (없는 혜택은 무시)

- **`getDiscountComponents` 함수**: 할인 결과에서 할인 유형 정보 추출

  - 네이버멤버십, 통신사 멤버십, 카드할인 등 다양한 할인 유형 구분
  - 즉시할인, 적립, 캐시백 유형별 컴포넌트 정보 생성
  - 매장 ID를 활용한 매장별 맞춤형 할인 정보 생성

- **`getDiscountTypeStyles` 함수**: 할인 유형별 스타일링 정보 제공

  - 즉시할인(녹색), 적립(파란색), 캐시백(노란색) 스타일 설정
  - 배경색, 테두리색, 텍스트색 일관된 스타일 적용

- **`getFriendlyMethodName` 함수**: 할인 방법명을 사용자 친화적으로 변환

  - 중앙 집중식 `friendlyNameMap` 객체로 명칭 관리
  - 복잡한 할인 방법명을 이해하기 쉬운 형태로 표시
  - 예: "네이버멤버십 + 네이버페이" → "네이버 멤버십 혜택"

- **`getDiscountMethodIcon` 함수**: 할인 방법에 따른 아이콘 이름 제공
  - `discountIconMap` 객체를 통한 아이콘 매핑 관리
  - 네이버, 카카오페이, 통신사 멤버십 등 각 할인 방법별 적절한 아이콘 선택

#### 새로운 UI 기능

- **복수 할인 방법 표시**: 여러 할인 수단을 동시에 적용할 경우(예: T멤버십 + 카카오페이 굿딜) 영수증의 즉시할인 항목에 모든 할인 방법이 나열되어 표시됨
- **카카오페이 굿딜 지원**: 카카오페이 굿딜 3% 할인 옵션이 할인 필터에 추가되고 계산 결과에 반영됨
- **할인 정보 개선**: 즉시할인과 미래혜택을 구분하여 더 명확하게 표시
- **영수증 스타일 UI**: 최적 할인 방법을 영수증 형태로 직관적으로 표시
- **할인 유형별 색상 구분**: 즉시할인(녹색), 적립(파란색), 캐시백(노란색)으로 유형별 시각적 구분
- **툴팁 정보 제공**: 체감가 등 주요 개념에 대한 설명을 툴팁으로 제공

### 매장 정보 UI

#### 매장 목록 (`StoreGrid.tsx`)

- 그리드 형태로 매장 카드 배열
- 매장별 간략 정보 표시
- 반응형 그리드 (화면 크기에 따라 열 수 조정)

#### 매장 카드 (`StoreCard.tsx`)

- 매장 로고/이미지
- 매장 이름
- 간략한 할인 정보
- 클릭 시 해당 매장 상세 페이지로 이동

### 할인 정보 표시 스타일링

#### 정보 툴팁

- 할인 관련 용어 설명을 위한 툴팁
- `HelpCircle`, `Info` 아이콘으로 표시
- 사용자가 아이콘에 마우스 오버 시 추가 정보 표시

## UI 컴포넌트 라이브러리

할인도우미는 ShadCN UI 컴포넌트 라이브러리를 기반으로 구축되었습니다:

- `card`: 정보 그룹화 및 표시
- `button`: 다양한 상호작용 버튼
- `input`: 사용자 입력 필드
- `checkbox`: 토글 옵션
- `tabs`: 탭 인터페이스
- `table`: 데이터 테이블
- `tooltip`: 추가 정보 툴팁
- `label`: 폼 요소 레이블
- `radio-group`: 옵션 선택
- `scroll-area`: 스크롤 영역

## 광고 UI

### Google AdSense (`AdSense.tsx`)

- **인라인 배너 형식**: 페이지 컨텐츠 흐름의 일부로 자연스럽게 통합된 광고
- **위치**: 페이지 콘텐츠 하단에 위치하여 콘텐츠 소비 후 노출
- **반응형 설계**: 다양한 화면 크기에 맞게 자동 조정되는 광고 크기
- **최소 높이 설정**: 광고 영역이 일정 크기를 유지하여 페이지 레이아웃 안정성 보장
- **오류 처리**: 광고 로드 실패 시 최소 공간만 차지하도록 설계
- **스타일링**:
  - 상단 테두리로 콘텐츠와 구분
  - 적절한 여백으로 가독성 향상
  - 중앙 정렬로 시각적 균형 유지

### 광고 배치 전략

**인라인 배너 접근법 (현재 구현)**

- 스크롤과 함께 움직이는 자연스러운 광고 배치
- 콘텐츠 흐름을 방해하지 않는 비침투적 사용자 경험
- 페이지 콘텐츠에 자연스럽게 통합

이전 구현에서는 다음과 같은 방식을 사용했으나 현재는 사용자 경험 향상을 위해 인라인 방식으로 변경:

- **고정 배너 (이전 구현)**: 스크롤과 무관하게 항상 화면 하단에 표시
- **스크롤 트리거 배너 (미구현)**: 특정 스크롤 위치에 도달했을 때만 표시

### AdSense 컴포넌트 사용 예시

```tsx
// 페이지 하단 인라인 배너
<div className="w-full bg-white mt-8 border-t pt-4">
  <AdSense
    slot="1234567890"
    style={{
      display: "block",
      textAlign: "center",
      margin: "0 auto",
      minHeight: "60px",
      maxHeight: "90px",
      overflow: "hidden",
    }}
    format="auto"
    responsive={true}
    minHeight="60px"
  />
</div>

// StoreGrid 내의 콘텐츠 사이 광고
<div className="col-span-3 md:col-span-3 lg:col-span-4 my-4">
  <AdSense
    slot="1111222233"
    format="fluid"
    responsive={true}
    style={{
      display: "block",
      textAlign: "center",
      maxWidth: "100%",
      margin: "0 auto",
    }}
  />
</div>
```

## 반응형 디자인

- 모든 UI 컴포넌트는 모바일과 데스크톱 환경에 최적화
- 모바일: 탭 기반 간결한 UI, 세로 스크롤 중심
- 데스크톱: 풍부한 정보 표시, 테이블 및 그래프 활용
- 미디어 쿼리 훅(`useMediaQuery`)을 사용하여 화면 크기에 따른 UI 전환
- 광고 영역도 화면 크기에 맞게 자동 조정되는 반응형 디자인

# 할인도우미 UI 구조 시각화

## 모바일 UI 레이아웃 (화면 너비 < 768px)

```
+--------------------------------------------------+
|                    Header.tsx                     |
|  +--------------------+  +-------------------+   |
|  |   로고(Percent)    |  |  내비게이션 메뉴  |   |
|  |   할인도우미       |  |  (꿀팁/연락하기)  |   |
|  | [Percent 아이콘] |  |  [Lightbulb]      |   |
|  | 할인도우미 텍스트 |  |                  |   |
|  +--------------------+  +-------------------+   |
+--------------------------------------------------+
|                                                  |
|  +----------------------------------------------+|
|  |                 AmountInput 컴포넌트        ||
|  |  +-------------------+ +------------------+ ||
|  |  |  금액 입력 필드   | |    POP 체크박스   | ||
|  |  +-------------------+ +------------------+ ||
|  |  +--------+ +--------+ +------------------+ ||
|  |  | +1000원 | | +100원 | |    초기화 버튼   | ||
|  |  +--------+ +--------+ +------------------+ ||
|  +----------------------------------------------+|
|                                                  |
|  +----------------------------------------------+|
|  |              최적의 결제 방법               ||
|  |  +-----------------------------------------+ ||
|  |  |           멤버십 섹션                   | ||
|  |  |   +---------------------------------+   | ||
|  |  |   |       통신사 멤버십 선택        |   | ||
|  |  |   | (없음, SKT, KT, LG)             |   | ||
|  |  |   +---------------------------------+   | ||
|  |  |   +---------------------------------+   | ||
|  |  |   |       기타 멤버십 선택          |   | ||
|  |  |   | (네이버 멤버십)                 |   | ||
|  |  |   +---------------------------------+   | ||
|  |  +-----------------------------------------+ ||
|  |  +-----------------------------------------+ ||
|  |  |           결제 방법 섹션               | ||
|  |  |   +---------------------------------+   | ||
|  |  |   |       간편결제 선택             |   | ||
|  |  |   | (네이버페이, 카카오페이, 토스페이)|  | ||
|  |  |   +---------------------------------+   | ||
|  |  |   +---------------------------------+   | ||
|  |  |   |       카드 할인 선택            |   | ||
|  |  |   | (할인카드 + 할인률 입력)        |   | ||
|  |  |   +---------------------------------+   | ||
|  |  +-----------------------------------------+ ||
|  +----------------------------------------------+|
|                                                  |
|  +----------------------------------------------+|
|  |             DiscountResult 컴포넌트         ||
|  |  +-----------------------------------------+ ||
|  |  |            탭 메뉴 인터페이스           | ||
|  |  | +-------+ +----------+ +--------------+ | ||
|  |  | |최적할인| |전체 목록 | |  용어 설명   | | ||
|  |  | +-------+ +----------+ +--------------+ | ||
|  |  +-----------------------------------------+ ||
|  |                                             ||
|  |  /* 최적 할인 탭 내용 */                   ||
|  |  +-----------------------------------------+ ||
|  |  |           할인 영수증 형태 UI           | ||
|  |  | +-----------------------------------+   | ||
|  |  | |         할인 영수증 헤더          |   | ||
|  |  | |   날짜 및 "할인 영수증" 타이틀    |   | ||
|  |  | +-----------------------------------+   | ||
|  |  | +-----------------------------------+   | ||
|  |  | |          최적 할인 방법           |   | ||
|  |  | |              방법명               |   | ||
|  |  | +-----------------------------------+   | ||
|  |  | +-----------------------------------+   | ||
|  |  | |           총 할인 혜택            |   | ||
|  |  | |  금액(XXX원) + 할인율(XX.X%)      |   | ||
|  |  | +-----------------------------------+   | ||
|  |  | +-----------------------------------+   | ||
|  |  | |            항목 목록              |   | ||
|  |  | | - 원래 금액: XXX원                |   | ||
|  |  | | - 즉시 할인: -XXX원 (녹색)        |   | ||
|  |  | |   * 복수 할인 목록으로 표시       |   | ||
|  |  | |   * T 멤버십 할인                |   | ||
|  |  | |   * 카카오페이 굿딜 3% 할인      |   | ||
|  |  | | - 실 결제액: XXX원 (굵게)         |   | ||
|  |  | | - 미래 혜택: -XXX원 (파란색)      |   | ||
|  |  | | - 체감가: XXX원 (빨간색)          |   | ||
|  |  | +-----------------------------------+   | ||
|  |  | +-----------------------------------+   | ||
|  |  | |          참고사항 (조건부)        |   | ||
|  |  | |          할인 관련 노트           |   | ||
|  |  | +-----------------------------------+   | ||
|  |  | +-----------------------------------+   | ||
|  |  | |           바코드 영역             |   | ||
|  |  | | - 바코드 이미지                   |   | ||
|  |  | | - 거래 번호                       |   | ||
|  |  | | - 안내 메시지                     |   | ||
|  |  | +-----------------------------------+   | ||
|  |  | +-----------------------------------+   | ||
|  |  | |           절취선 영역             |   | ||
|  |  | |    (가위 아이콘 + 점선)           |   | ||
|  |  | +-----------------------------------+   | ||
|  |  +-----------------------------------------+ ||
|  |                                             ||
|  |  /* 전체 목록 탭 내용 */                   ||
|  |  +-----------------------------------------+ ||
|  |  |            할인 방법 카드 1             | ||
|  |  | +-------------------------------------+ | ||
|  |  | | 헤더: 결제방법, 총혜택, 할인율     | | ||
|  |  | | [펼치기/접기 버튼]                 | | ||
|  |  | +-------------------------------------+ | ||
|  |  | | 상세 정보 (펼침 시)                | | ||
|  |  | | - 체감가                           | | ||
|  |  | | - 즉시 할인                        | | ||
|  |  | | - 미래 혜택                        | | ||
|  |  | | - 참고사항 (조건부)                | | ||
|  |  | +-------------------------------------+ | ||
|  |  +-----------------------------------------+ ||
|  |  +-----------------------------------------+ ||
|  |  |            할인 방법 카드 2             | ||
|  |  | +-------------------------------------+ | ||
|  |  | | 헤더: 결제방법, 총혜택, 할인율     | | ||
|  |  | | [접힘 상태]                        | | ||
|  |  | +-------------------------------------+ | ||
|  |  +-----------------------------------------+ ||
|  |                                             ||
|  |  /* 용어 설명 탭 내용 */                   ||
|  |  +-----------------------------------------+ ||
|  |  |         할인 관련 용어 설명 목록        | ||
|  |  +-----------------------------------------+ ||
|  +----------------------------------------------+|
+--------------------------------------------------+
```

## 데스크톱 UI 레이아웃 (화면 너비 >= 768px) - 개선된 버전

```
+-----------------------------------------------------------------------------------+
|                                  Header.tsx                                        |
|  +----------------------+  +------------------+  +----------------------------+    |
|  |        로고          |  |       꿀팁       |  |       연락하기             |    |
|  | [Percent 아이콘]     |  |   [Lightbulb]    |  |    [MessageCircle]         |    |
|  | 할인도우미 텍스트    |  |                  |  |                            |    |
|  +----------------------+  +------------------+  +----------------------------+    |
+-----------------------------------------------------------------------------------+
|                                                                                   |
|  +----------------------------------------------+                                 |
|  |               AmountInput 영역               |                                 |
|  |  +----------------------------------------+  |                                 |
|  |  | 금액: [ 입력 필드 ] 원  [POP] 체크박스 |  |                                 |
|  |  +----------------------------------------+  |                                 |
|  |  | +1000원 | | +100원 | | 초기화 |        |  |                                 |
|  |  +----------------------------------------+  |                                 |
|  |                                              |                                 |
|  +----------------------------------------------+                                 |
|                                                                                   |
|  +----------------------------------------------+                                 |
|  |             DiscountFilter 영역              |                                 |
|  |  +----------------------------------------+  |                                 |
|  |  |              멤버십 섹션               |  |                                 |
|  |  | [ SKT ] [ KT ] [ U+ ] [ 네이버멤버십 ] |  |                                 |
|  |  +----------------------------------------+  |                                 |
|  |  |              결제 방법 섹션            |  |                                 |
|  |  | [ 네이버페이 ] [ 카카오페이 ] [ 토스 ] |  |                                 |
|  |  | [ 할인카드 ] [ 할인률 입력 필드 ]%     |  |                                 |
|  |  +----------------------------------------+  |                                 |
|  |                                              |                                 |
|  +----------------------------------------------+                                 |
|                                                                                   |
|  +-----------------------------------------------------------------------------+ |
|  |                            결과 카드 (2단 그리드)                           | |
|  |                                                                             | |
|  | +----------------------------------+ +-------------------------------+      | |
|  | |           할인 영수증            | |        할인 결과 테이블        |      | |
|  | |          (좌측 고정)             | |         (우측 스크롤)          |      | |
|  | |                                  | |                               |      | |
|  | | [최적 할인 또는 선택된 할인 방법] | | +-------------------------+   |      | |
|  | |                                  | | | 총혜택 | 체감가 | 방법    |   |      | |
|  | | +----------------------------+   | | |-------|--------|---------|   |      | |
|  | | |       영수증 헤더          |   | | | 1,500원| 8,500원|네이버+KT|   |      | |
|  | | +----------------------------+   | | |       |        |         |   |      | |
|  | |                                  | | | [다른 할인 방법들 나열]   |   |      | |
|  | | +----------------------------+   | | +-------------------------+   |      | |
|  | | |      최적/선택 할인 방법   |   | |                               |      | |
|  | | +----------------------------+   | |                               |      | |
|  | |                                  | |   * 행 클릭 → 영수증 업데이트  |      | |
|  | | +----------------------------+   | |   * Hover 효과로 클릭 유도     |      | |
|  | | |        총 할인 혜택        |   | |                               |      | |
|  | | +----------------------------+   | |                               |      | |
|  | |                                  | |                               |      | |
|  | | +----------------------------+   | |                               |      | |
|  | | |         할인 항목들        |   | |                               |      | |
|  | | +----------------------------+   | |                               |      | |
|  | |                                  | |                               |      | |
|  | | [영수증이 스크롤해도 화면에 고정] | |                               |      | |
|  | +----------------------------------+ +-------------------------------+      | |
|  +-----------------------------------------------------------------------------+ |
+-----------------------------------------------------------------------------------+
```

### 데스크톱 레이아웃 주요 개선사항

#### 2단 그리드 레이아웃

- **영수증-테이블 병렬 표시**: 할인 영수증과 할인 테이블을 좌우로 나란히 배치
- **스티키(sticky) 영수증**: 스크롤 시에도 영수증 고정 위치 유지로 항상 할인 정보 확인 가능
- **최적화된 수직 공간**: 세로 스크롤 최소화로 사용자 경험 개선

#### 테이블 행 클릭 기능

- **인터랙티브 테이블 행**: 각 할인 방법 행에 클릭 이벤트 추가
- **실시간 영수증 업데이트**: 행 클릭 시 좌측 영수증이 선택한 할인 방법으로 즉시 업데이트
- **시각적 피드백**:
  - 선택된 행에 푸른 배경색 적용
  - 호버 효과로 클릭 가능 행 시각화
  - 커서 포인터로 클릭 가능 표시
- **최적 할인으로 복귀**: 영수증 상단의 버튼으로 언제든지 최적 할인 방법으로 복귀 가능

#### 테이블 컬럼 최적화

- **필수 정보 중심**: 테이블 컬럼을 최적화하여 중요 정보만 표시
- **좁은 너비 컬럼**: 컬럼 너비 최적화로 한 화면에 더 많은 정보 표시
- **불필요한 열 삭제**: 공간 확보를 위해 불필요한 '할인 전' 열 제거

## 최근 UI 변경사항

### 2024년 스크롤 최적화 및 상호작용 개선

- **2단 그리드 레이아웃 적용**: 할인 영수증과 테이블을 나란히 배치하여 스크롤 감소
- **테이블 행 클릭 기능 추가**: 할인 방법 행 클릭으로 해당 할인 정보 즉시 영수증에 표시
- **고정 위치 영수증(sticky)**: 스크롤과 무관하게 영수증을 화면에 고정
- **테이블 UI 개선**: 컬럼 최적화 및 클릭 가능한 행 디자인 적용
- **시각적 피드백 강화**: 선택 상태와 호버 효과로 사용자 경험 개선
